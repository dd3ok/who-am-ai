# Plan+Design — Google GenAI API Key 설정 재정비

## 목적 / 문제정의
- Vertex 기반 설정을 제거하고 Gemini Developer API Key 모드만 사용할 때 필요한 최소 속성을 정의한다.
- `Google GenAI project-id must be set!` 예외가 다시 발생하지 않도록 Spring AI 자동 구성 경로를 API Key 모드로 명확히 고정한다.

## 범위(Scope)
- 포함: `application.yml` 내 `spring.ai.google.genai` 및 `spring.ai.google.genai.embedding` 섹션 조정, 필요 속성(API Key, 모델 옵션) 점검.
- 제외: MongoDB/VectorStore 구조, Gemini SDK 커스텀 Config, 배포 스크립트.

## 입력 / 출력 / 의존성
- 입력: 현재 `application.yml`, 에러 로그, Spring AI 공식 문서 (see: /spring-projects/spring-ai).
- 출력: API Key 모드만 사용하는 설정 파일과 Implement 문서.
- 참조: Spring AI Google GenAI Chat/Embedding(Developer API) 가이드 see: Principles#참조표기규칙 → /spring-projects/spring-ai.
- 환경: Spring Boot 3.x, Kotlin, Spring AI 1.x.

## 데이터 흐름(DFD) / 시퀀스
1. 환경 변수에서 `GEMINI_API_KEY`만 주입.
2. Spring AI Google GenAI AutoConfig가 API Key 모드로 `GoogleGenAiEmbeddingConnectionDetails`를 생성.
3. MongoDB VectorStore AutoConfig가 임베딩 모델 빈을 받아 초기화.

## 설계(아키텍처 / 모듈 / 의존성)
- 설정 계층: `spring.ai.google.genai` → 공통 API Key, 모델 옵션.
- 임베딩 섹션: `spring.ai.google.genai.embedding.api-key`(선택) 없이 상위 api-key 공유, 모델/태스크 옵션 유지.
- Vertex 관련 project-id/location 필드 제거 → AutoConfig가 Developer API 경로 선택.

## 리스크 / 가정
- 리스크: 향후 Vertex 모드 전환 필요 시 다시 속성을 추가해야 함.
- 가정: 모든 배포 환경이 Gemini Developer API Key 사용을 허용하며 할당량이 충분함.

## 완료 기준(DoD)
- `application.yml`에서 project-id/location 관련 항목 제거 및 API Key 중심 구성이 적용됨.
- Why/Scope 기록과 테스트 시나리오가 구현 문서에 정리됨.
- 재기동 시 project-id 관련 예외가 재현되지 않음(문서상 기대 결과).

## Why / Scope 기록
- Why: 명시적으로 API Key 모드만 쓰겠다는 요구에 따라 불필요한 Vertex 속성을 제거해야 함.
- Scope: 설정 파일 편집 및 문서화에 한정.
